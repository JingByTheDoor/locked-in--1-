[gd_scene load_steps=28 format=3 uid="uid://chlluuui0410t"]

[ext_resource type="Script" uid="uid://bjvfys8e3cajl" path="res://Scripts/ScavengeRun.gd" id="1"]
[ext_resource type="PackedScene" uid="uid://x4khlkw6qu05" path="res://Scenes/Player.tscn" id="2"]
[ext_resource type="PackedScene" uid="uid://dv3s6lpqlvwwb" path="res://Scenes/Guard.tscn" id="3"]
[ext_resource type="PackedScene" path="res://Scenes/ExtractionZone.tscn" id="4"]
[ext_resource type="PackedScene" path="res://Scenes/LootPickup.tscn" id="5"]
[ext_resource type="PackedScene" path="res://Scenes/HidingSpot.tscn" id="6"]
[ext_resource type="PackedScene" path="res://VFX/SoundRippleManager.tscn" id="7"]
[ext_resource type="PackedScene" uid="uid://cara0s7t3nq75" path="res://VFX/VisionMask.tscn" id="8"]
[ext_resource type="PackedScene" path="res://VFX/ReadabilityOverlay.tscn" id="9"]
[ext_resource type="PackedScene" path="res://UI/ExitSignLayer.tscn" id="10"]
[ext_resource type="PackedScene" path="res://UI/HuntedBanner.tscn" id="11"]
[ext_resource type="PackedScene" path="res://UI/MessageHud.tscn" id="12"]
[ext_resource type="Script" uid="uid://dspas587cy1x1" path="res://Scripts/EscalationManager.gd" id="13"]
[ext_resource type="PackedScene" path="res://Scenes/Hunter.tscn" id="14"]
[ext_resource type="Texture2D" uid="uid://wyj60w1c6a8u" path="res://icon.svg" id="15"]
[ext_resource type="PackedScene" path="res://Scenes/Watcher.tscn" id="16"]
[ext_resource type="PackedScene" path="res://Scenes/BreakableProp.tscn" id="17"]
[ext_resource type="Script" uid="uid://md4m5ar0w1ly" path="res://Scripts/MapRules.gd" id="18"]
[ext_resource type="PackedScene" path="res://UI/InteractPrompt.tscn" id="19"]

[sub_resource type="RectangleShape2D" id="1"]
size = Vector2(1200, 40)

[sub_resource type="RectangleShape2D" id="2"]
size = Vector2(40, 800)

[sub_resource type="RectangleShape2D" id="3"]
size = Vector2(40, 180)

[sub_resource type="RectangleShape2D" id="5"]
size = Vector2(40, 160)

[sub_resource type="RectangleShape2D" id="4"]
size = Vector2(40, 200)

[sub_resource type="RectangleShape2D" id="6"]
size = Vector2(160, 40)

[sub_resource type="RectangleShape2D" id="7"]
size = Vector2(80, 80)

[sub_resource type="RectangleShape2D" id="8"]
size = Vector2(120, 60)

[node name="ScavengeRun" type="Node2D"]
script = ExtResource("1")

[node name="MapRules" type="Node" parent="."]
script = ExtResource("18")

[node name="PlayerSpawns" type="Node2D" parent="."]

[node name="SpawnA" type="Node2D" parent="PlayerSpawns"]
position = Vector2(-520, 320)

[node name="SpawnB" type="Node2D" parent="PlayerSpawns"]
position = Vector2(-520, -320)

[node name="SpawnC" type="Node2D" parent="PlayerSpawns"]
position = Vector2(520, 320)

[node name="SpawnD" type="Node2D" parent="PlayerSpawns"]
position = Vector2(520, -320)

[node name="Map" type="Node2D" parent="."]

[node name="OuterWallTop" type="StaticBody2D" parent="Map"]
position = Vector2(0, -420)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/OuterWallTop"]
shape = SubResource("1")

[node name="Sprite2D" type="Sprite2D" parent="Map/OuterWallTop"]
modulate = Color(0.15, 0.15, 0.15, 1)
scale = Vector2(6, 0.25)
texture = ExtResource("15")

[node name="OuterWallBottom" type="StaticBody2D" parent="Map"]
position = Vector2(0, 420)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/OuterWallBottom"]
shape = SubResource("1")

[node name="Sprite2D" type="Sprite2D" parent="Map/OuterWallBottom"]
modulate = Color(0.15, 0.15, 0.15, 1)
scale = Vector2(6, 0.25)
texture = ExtResource("15")

[node name="OuterWallLeft" type="StaticBody2D" parent="Map"]
position = Vector2(-620, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/OuterWallLeft"]
shape = SubResource("2")

[node name="Sprite2D" type="Sprite2D" parent="Map/OuterWallLeft"]
modulate = Color(0.15, 0.15, 0.15, 1)
scale = Vector2(0.25, 6)
texture = ExtResource("15")

[node name="OuterWallRight" type="StaticBody2D" parent="Map"]
position = Vector2(620, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/OuterWallRight"]
shape = SubResource("2")

[node name="Sprite2D" type="Sprite2D" parent="Map/OuterWallRight"]
modulate = Color(0.15, 0.15, 0.15, 1)
scale = Vector2(0.25, 6)
texture = ExtResource("15")

[node name="WallLeftTop" type="StaticBody2D" parent="Map"]
position = Vector2(-200, -280)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallLeftTop"]
shape = SubResource("3")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallLeftTop"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.4)
texture = ExtResource("15")

[node name="WallLeftMid" type="StaticBody2D" parent="Map"]
position = Vector2(-200, -20)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallLeftMid"]
shape = SubResource("3")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallLeftMid"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.4)
texture = ExtResource("15")

[node name="WallLeftBottom" type="StaticBody2D" parent="Map"]
position = Vector2(-200, 240)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallLeftBottom"]
shape = SubResource("3")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallLeftBottom"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.4)
texture = ExtResource("15")

[node name="WallRightTop" type="StaticBody2D" parent="Map"]
position = Vector2(200, -300)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallRightTop"]
shape = SubResource("5")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallRightTop"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.2)
texture = ExtResource("15")

[node name="WallRightMid" type="StaticBody2D" parent="Map"]
position = Vector2(200, -60)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallRightMid"]
shape = SubResource("4")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallRightMid"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.6)
texture = ExtResource("15")

[node name="WallRightBottom" type="StaticBody2D" parent="Map"]
position = Vector2(200, 180)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallRightBottom"]
shape = SubResource("4")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallRightBottom"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(0.25, 1.6)
texture = ExtResource("15")

[node name="WallRightH1" type="StaticBody2D" parent="Map"]
position = Vector2(300, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallRightH1"]
shape = SubResource("6")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallRightH1"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(1.2, 0.25)
texture = ExtResource("15")

[node name="WallRightH2" type="StaticBody2D" parent="Map"]
position = Vector2(520, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallRightH2"]
shape = SubResource("6")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallRightH2"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(1.2, 0.25)
texture = ExtResource("15")

[node name="WallLeftH1" type="StaticBody2D" parent="Map"]
position = Vector2(-420, 140)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/WallLeftH1"]
shape = SubResource("6")

[node name="Sprite2D" type="Sprite2D" parent="Map/WallLeftH1"]
modulate = Color(0.2, 0.2, 0.2, 1)
scale = Vector2(1.2, 0.25)
texture = ExtResource("15")

[node name="CrateA" type="StaticBody2D" parent="Map"]
position = Vector2(-480, -80)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/CrateA"]
shape = SubResource("7")

[node name="Sprite2D" type="Sprite2D" parent="Map/CrateA"]
modulate = Color(0.35, 0.3, 0.2, 1)
scale = Vector2(0.6, 0.6)
texture = ExtResource("15")

[node name="CrateB" type="StaticBody2D" parent="Map"]
position = Vector2(60, 260)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/CrateB"]
shape = SubResource("8")

[node name="Sprite2D" type="Sprite2D" parent="Map/CrateB"]
modulate = Color(0.35, 0.3, 0.2, 1)
scale = Vector2(0.9, 0.45)
texture = ExtResource("15")

[node name="CrateC" type="StaticBody2D" parent="Map"]
position = Vector2(440, -220)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/CrateC"]
shape = SubResource("7")

[node name="Sprite2D" type="Sprite2D" parent="Map/CrateC"]
modulate = Color(0.35, 0.3, 0.2, 1)
scale = Vector2(0.6, 0.6)
texture = ExtResource("15")

[node name="ExitSignWorld" type="Sprite2D" parent="Map"]
modulate = Color(0.35, 1, 0.55, 1)
position = Vector2(520, -320)
scale = Vector2(0.4, 0.4)
texture = ExtResource("15")

[node name="ExitSignWorld2" type="Sprite2D" parent="Map"]
modulate = Color(0.35, 1, 0.55, 1)
position = Vector2(-520, 320)
scale = Vector2(0.4, 0.4)
texture = ExtResource("15")

[node name="Player" parent="." instance=ExtResource("2")]
position = Vector2(-520, 0)
move_speed = null
sprint_multiplier = null
interact_radius = null
idle_animation_name = null
walk_animation_name = null
attack_arc_degrees = null
attack_range = null
attack_windup = null
attack_active_time = null
attack_cooldown = null
attack_damage = null
attack_knockback = null
emit_air_swing_sound = null
air_swing_radius = null
air_swing_loudness = null
hit_loudness_enemy = null
hit_radius_enemy = null
hit_loudness_wall = null
hit_radius_wall = null
enemy_hit_color = null
wall_hit_color = null
walk_sound_interval = null
sprint_sound_interval = null
walk_sound_radius = null
sprint_sound_radius = null
walk_sound_loudness = null
sprint_sound_loudness = null
gun_enabled = null
gun_damage = null
gun_range = null
gun_fire_cooldown = null
gun_knockback = null
gun_shot_loudness = null
gun_shot_radius = null
gun_empty_message = null
gun_collision_mask = null
gun_muzzle_offset = null
default_prompt_text = null
carry_rank_min = null
carry_rank_max = null
carry_speed_step = null
carry_noise_step = null

[node name="ExtractionZone" parent="." instance=ExtResource("4")]
position = Vector2(520, -260)
interact_duration = null
base_scene_path = null
start_message = null
complete_message = null
cancel_message = null
extraction_loudness = null
extraction_radius = null
prompt_text = null

[node name="ExtractionZone2" parent="." instance=ExtResource("4")]
position = Vector2(-520, 260)
interact_duration = null
base_scene_path = null
start_message = null
complete_message = null
cancel_message = null
extraction_loudness = null
extraction_radius = null
prompt_text = null

[node name="LootScrap1" parent="." instance=ExtResource("5")]
position = Vector2(-520, -260)
loot_type = null
amount = 3
grade = null
carry_rank_add = null
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="LootWood1" parent="." instance=ExtResource("5")]
position = Vector2(-420, 220)
loot_type = 1
amount = 2
grade = null
carry_rank_add = null
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="LootAmmo1" parent="." instance=ExtResource("5")]
position = Vector2(20, -260)
loot_type = 4
amount = 6
grade = null
carry_rank_add = null
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="LootFood1" parent="." instance=ExtResource("5")]
position = Vector2(420, 220)
loot_type = 3
amount = null
grade = 2
carry_rank_add = 2
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="LootFuel1" parent="." instance=ExtResource("5")]
position = Vector2(120, 320)
loot_type = 2
amount = null
grade = null
carry_rank_add = 2
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="LootScrap2" parent="." instance=ExtResource("5")]
position = Vector2(300, -140)
loot_type = null
amount = 2
grade = null
carry_rank_add = null
pickup_loudness = null
pickup_radius = null
pickup_anomaly = null
deny_when_escape_only = null
prompt_text = null

[node name="BreakableCrate1" parent="." instance=ExtResource("17")]
position = Vector2(-320, -120)
max_hp = null
break_loudness = null
break_radius = null
break_tag = null
break_color = null
intact_color = null
broken_color = null
break_on_interact = null
disable_collision_on_break = null

[node name="BreakableCrate2" parent="." instance=ExtResource("17")]
position = Vector2(120, 80)
max_hp = null
break_loudness = null
break_radius = null
break_tag = null
break_color = null
intact_color = null
broken_color = null
break_on_interact = null
disable_collision_on_break = null

[node name="BreakableGlass1" parent="." instance=ExtResource("17")]
position = Vector2(420, -80)
max_hp = null
break_loudness = null
break_radius = null
break_tag = null
break_color = Color(0.6, 0.8, 1, 0.9)
intact_color = Color(0.55, 0.7, 0.9, 1)
broken_color = Color(0.35, 0.4, 0.5, 1)
break_on_interact = null
disable_collision_on_break = null

[node name="HidingSpot1" parent="." instance=ExtResource("6")]
position = Vector2(-520, 320)

[node name="HidingSpot2" parent="." instance=ExtResource("6")]
position = Vector2(540, -320)

[node name="UnfairRoom" type="Node2D" parent="."]
position = Vector2(420, -220)

[node name="GuardLeft" parent="." instance=ExtResource("3")]
position = Vector2(-360, -200)
patrol_speed = null
investigate_speed = null
chase_speed = null
arrival_distance = null
attack_range = null
attack_damage = null
attack_cooldown = null
lose_interest_time = null
hearing_multiplier = null
min_hearing_radius = null
max_hearing_radius = null
alert_hit_points = null
knockback_decay = null
knockback_resistance = null
callout_enabled = null
callout_cooldown = null
callout_loudness = null
callout_radius = null
patrol_path = NodePath("../PatrolPathLeft")
player_path = null
idle_animation_name = null
walk_animation_name = null
aim_rotation_offset_degrees = null
debug_state_colors = null
patrol_color = null
investigate_color = null
chase_color = null

[node name="GuardCenter" parent="." instance=ExtResource("3")]
position = Vector2(-40, -200)
patrol_speed = null
investigate_speed = null
chase_speed = null
arrival_distance = null
attack_range = null
attack_damage = null
attack_cooldown = null
lose_interest_time = null
hearing_multiplier = null
min_hearing_radius = null
max_hearing_radius = null
alert_hit_points = null
knockback_decay = null
knockback_resistance = null
callout_enabled = null
callout_cooldown = null
callout_loudness = null
callout_radius = null
patrol_path = NodePath("../PatrolPathCenter")
player_path = null
idle_animation_name = null
walk_animation_name = null
aim_rotation_offset_degrees = null
debug_state_colors = null
patrol_color = null
investigate_color = null
chase_color = null

[node name="GuardRight" parent="." instance=ExtResource("3")]
position = Vector2(340, 160)
patrol_speed = null
investigate_speed = null
chase_speed = null
arrival_distance = null
attack_range = null
attack_damage = null
attack_cooldown = null
lose_interest_time = null
hearing_multiplier = null
min_hearing_radius = null
max_hearing_radius = null
alert_hit_points = null
knockback_decay = null
knockback_resistance = null
callout_enabled = null
callout_cooldown = null
callout_loudness = null
callout_radius = null
patrol_path = NodePath("../PatrolPathRight")
player_path = null
idle_animation_name = null
walk_animation_name = null
aim_rotation_offset_degrees = null
debug_state_colors = null
patrol_color = null
investigate_color = null
chase_color = null

[node name="GuardSouth" parent="." instance=ExtResource("3")]
position = Vector2(120, 300)
patrol_speed = null
investigate_speed = null
chase_speed = null
arrival_distance = null
attack_range = null
attack_damage = null
attack_cooldown = null
lose_interest_time = null
hearing_multiplier = null
min_hearing_radius = null
max_hearing_radius = null
alert_hit_points = null
knockback_decay = null
knockback_resistance = null
callout_enabled = null
callout_cooldown = null
callout_loudness = null
callout_radius = null
patrol_path = NodePath("../PatrolPathSouth")
player_path = null
idle_animation_name = null
walk_animation_name = null
aim_rotation_offset_degrees = null
debug_state_colors = null
patrol_color = null
investigate_color = null
chase_color = null

[node name="WatcherA" parent="." instance=ExtResource("16")]
position = Vector2(260, -40)
patrol_speed = null
investigate_speed = null
alert_speed = null
arrival_distance = null
lose_interest_time = null
hearing_multiplier = null
min_hearing_radius = null
max_hearing_radius = null
alarm_cooldown = null
alarm_loudness = null
alarm_radius = null
alarm_color = null
alarm_pulse_duration = null
patrol_path = NodePath("../WatcherPath")
player_path = null
idle_animation_name = null
walk_animation_name = null
aim_rotation_offset_degrees = null
debug_state_colors = null
patrol_color = null
investigate_color = null
alert_color = null

[node name="PatrolPathLeft" type="Node2D" parent="."]
position = Vector2(-450, -200)

[node name="PointA" type="Node2D" parent="PatrolPathLeft"]
position = Vector2(-80, -80)

[node name="PointB" type="Node2D" parent="PatrolPathLeft"]
position = Vector2(80, -80)

[node name="PointC" type="Node2D" parent="PatrolPathLeft"]
position = Vector2(80, 80)

[node name="PointD" type="Node2D" parent="PatrolPathLeft"]
position = Vector2(-80, 80)

[node name="PatrolPathCenter" type="Node2D" parent="."]
position = Vector2(0, -180)

[node name="PointA" type="Node2D" parent="PatrolPathCenter"]
position = Vector2(-80, -60)

[node name="PointB" type="Node2D" parent="PatrolPathCenter"]
position = Vector2(80, -60)

[node name="PointC" type="Node2D" parent="PatrolPathCenter"]
position = Vector2(80, 80)

[node name="PointD" type="Node2D" parent="PatrolPathCenter"]
position = Vector2(-80, 80)

[node name="PatrolPathRight" type="Node2D" parent="."]
position = Vector2(360, 180)

[node name="PointA" type="Node2D" parent="PatrolPathRight"]
position = Vector2(-80, -80)

[node name="PointB" type="Node2D" parent="PatrolPathRight"]
position = Vector2(120, -80)

[node name="PointC" type="Node2D" parent="PatrolPathRight"]
position = Vector2(120, 80)

[node name="PointD" type="Node2D" parent="PatrolPathRight"]
position = Vector2(-80, 80)

[node name="PatrolPathSouth" type="Node2D" parent="."]
position = Vector2(120, 300)

[node name="PointA" type="Node2D" parent="PatrolPathSouth"]
position = Vector2(-60, -40)

[node name="PointB" type="Node2D" parent="PatrolPathSouth"]
position = Vector2(60, -40)

[node name="PointC" type="Node2D" parent="PatrolPathSouth"]
position = Vector2(60, 40)

[node name="PointD" type="Node2D" parent="PatrolPathSouth"]
position = Vector2(-60, 40)

[node name="WatcherPath" type="Node2D" parent="."]
position = Vector2(260, -40)

[node name="PointA" type="Node2D" parent="WatcherPath"]
position = Vector2(-60, -40)

[node name="PointB" type="Node2D" parent="WatcherPath"]
position = Vector2(60, -40)

[node name="PointC" type="Node2D" parent="WatcherPath"]
position = Vector2(60, 40)

[node name="PointD" type="Node2D" parent="WatcherPath"]
position = Vector2(-60, 40)

[node name="SoundRippleManager" parent="." instance=ExtResource("7")]

[node name="AudioLayers" type="Node" parent="."]

[node name="TensionLayer" type="AudioStreamPlayer" parent="AudioLayers"]
volume_db = -30.0

[node name="HeartbeatLayer" type="AudioStreamPlayer" parent="AudioLayers"]
volume_db = -30.0

[node name="EscalationManager" type="Node2D" parent="."]
script = ExtResource("13")
local_noise_decay = null
local_noise_decay_investigate = null
local_noise_gain = null
local_noise_max = null
local_noise_recenter_strength = null
local_noise_reinforce_radius = null
global_pressure_decay = null
global_pressure_gain_per_anomaly = null
global_pressure_gain_per_second = null
global_pressure_floor_ratio = null
gun_pressure_boost = null
gun_local_noise_boost = null
gun_spike_timer_boost = null
major_event_window = null
major_event_required = null
major_event_pressure_threshold = null
major_event_local_boost = null
major_event_global_boost = null
major_event_spike_timer_boost = null
major_event_tags = null
investigate_threshold = null
pressure_threshold = null
hunted_pressure_threshold = null
hunted_spike_threshold = null
hunted_spike_time = null
overlay_path = NodePath("../ReadabilityOverlay")
tension_player_path = NodePath("../AudioLayers/TensionLayer")
heartbeat_player_path = NodePath("../AudioLayers/HeartbeatLayer")
message_hud_path = NodePath("../MessageHud")
hunted_message = null
hunter_scene = ExtResource("14")
hunter_spawn_min_distance = null
hunter_spawn_radius = null
hunter_spawn_attempts = null
alarm_message = null
callout_message = null
destruction_message = null
investigate_message = null
pressure_message = null
hunted_message_once = null
debug_noise_color = null
debug_noise_radius_min = null
debug_noise_radius_max = null

[node name="VisionMask" parent="." instance=ExtResource("8")]
target_path = NodePath("../Player/VisionCone")

[node name="ReadabilityOverlay" parent="." instance=ExtResource("9")]

[node name="ExitSignLayer" parent="." instance=ExtResource("10")]

[node name="HuntedBanner" parent="." instance=ExtResource("11")]

[node name="MessageHud" parent="." instance=ExtResource("12")]

[node name="InteractPrompt" parent="." instance=ExtResource("19")]
